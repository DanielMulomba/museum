// Données des artefacts (EXTRAITES de collections.html)
const artifactsData = {
  archaeology: [
    {
      img: 'images/collections/aartefact arch 1.jpeg',
      alt: 'Mycenaean Serpent Dagger',
      data: {
        "Name": "Mycenaean Serpent Dagger",
        "Material": "Bronze with gold inlay, niello decoration, and traces of organic residue (possible leather handle wrapping)",
        "Size/Weight/Shape": "Approximately 35 cm long, double-edged tapering blade with serpentine motif engraved along the fuller. Weight estimated between 400–600 g.",
        "Estimated Age": "Late Bronze Age, around 1500–1300 BCE, associated with Mycenaean Greece (possibly from Grave Circle A, Mycenae).",
        "Condition": "Excellent preservation with minor oxidation; gold inlay mostly intact; traces of sharpening marks under microscope.",
        "Find Location": "Excavated from a royal tomb in Mycenae, Peloponnese, Greece, in association with other elite grave goods.",
        "Use and Function": "Likely ceremonial weapon rather than for combat. Served as a symbol of rank, possibly carried by high-status warriors or chieftains.",
        "Probable Purpose": "Ritual or funerary use to accompany the deceased in the afterlife; also a marker of social prestige and power.",
        "Evidence of Use": "No significant blade wear, suggesting symbolic rather than utilitarian use. Minor scratches on the hilt area indicate handling.",
        "Manufacturing Clues": "Cast using the lost-wax technique; niello and gold applied through inlay and engraving; decorative serpentine motif references Mycenaean cosmology.",
        "Cultural Context": "Reflects Mycenaean craftsmanship influenced by Minoan metallurgy and Near Eastern luxury trade; demonstrates the warrior-elite ideology of Bronze Age Greece.",
        "Found With": "Gold cups, jewelry, seal stones, and bronze weapons.",
        "Burial or Habitat Context": "Funerary context—royal grave; positioned beside the deceased’s right hand, symbolizing authority in life and death.",
        "Symbolism": "The serpent motif represented immortality, protection, and the regenerative power of the earth and gods.",
        "Comparison": "Comparable to ceremonial daggers from Shaft Grave IV, Mycenae, and to Minoan blades from Knossos with similar inlay work.",
      }
    },
    {
      img: 'images/collections/aartefact arch 2.jpeg',
      alt: 'Nazca Ceremonial Vase',
      data: {
        "Name": "Nazca Ceremonial Vase",
        "Material": "Hand-modeled clay covered with mineral-based pigments (red, black, yellow, white), burnished before firing.",
        "Size/Weight/Shape": "About 25 cm high, 20 cm in diameter, globular form with flared rim and small base; weight approx. 1.5–2 kg.",
        "Estimated Age": "Early Intermediate Period, circa 200–600 CE, Nazca culture (southern coast of Peru).",
        "Condition": "Excellent; vivid polychrome still visible; minor abrasions along rim and base; stable firing cracks.",
        "Find Location": "Excavated in Cahuachi ceremonial center, Nazca Valley, Peru.",
        "Use and Function": "Likely used for ritual libations or offerings of maize beer (chicha) or blood during agricultural or funerary rites.",
        "Probable Purpose": "Religious and symbolic—connected to fertility, water cycles, and ancestral worship; possibly offered in ceremonial pits or temple contexts.",
        "Evidence of Use": "Traces of organic residue (fermented liquid), interior staining, and microabrasion inside rim suggest pouring use.",
        "Manufacturing Clues": "Hand-built and painted before firing using slip painting; geometric and anthropomorphic designs represent deities and natural forces.",
        "Cultural Context": "Nazca ceramics reflect complex religious iconography emphasizing fertility, water, and cosmic dualism; linked to geoglyph rituals.",
        "Found With": "Other painted vessels, ritual textiles, and miniature offerings.",
        "Burial or Habitat Context": "Deposited in ceremonial zones and elite burials; often found near mummified remains wrapped in Paracas-style textiles.",
        "Symbolism": "Color and motifs symbolized life, agricultural cycles, and spiritual transformation through ritual intoxication.",
        "Comparison": "Comparable to Moche ceremonial ceramics but distinguished by the Nazca’s abstract iconography and polychrome palette.",
      }
    },
    {
      img: 'images/collections/aartefact arch 3.jpeg',
      alt: 'Egyptian Funerary Mask',
      data: {
        "Name": "Egyptian Funerary Mask (Inspired by Tutankhamun)",
        "Material": "Gilded wood covered with gold leaf, inlaid with glass paste, obsidian, quartz, and lapis lazuli.",
        "Size/Weight/Shape": "Approximately 54 cm high, covering full head and shoulders; estimated weight 10–12 kg.",
        "Estimated Age": "New Kingdom, 18th Dynasty, circa 1323 BCE (Amarna period influence).",
        "Condition": "Excellent; minimal surface abrasion, small fissures in the wood base, original pigments largely intact.",
        "Find Location": "Modeled after discoveries from the Valley of the Kings, Thebes (modern Luxor), Egypt.",
        "Use and Function": "Placed over the face of the mummy to preserve the identity of the deceased in the afterlife and connect them to Osiris.",
        "Probable Purpose": "Religious and protective—ensuring the spirit (Ka) recognized the body and was guided to immortality.",
        "Evidence of Use": "Resin traces on the interior indicate direct contact with burial wrappings; gold surface bears micro-scratches from placement.",
        "Manufacturing Clues": "Crafted by royal goldsmiths using sheet gold applied to carved wood; stone and glass inlays meticulously fitted by hand.",
        "Cultural Context": "Reflects Egyptian theology linking kings to divine immortality; follows the artistic conventions of the 18th Dynasty.",
        "Found With": "Canopic jars, amulets, jewelry, and shabtis (funerary servant figurines).",
        "Burial or Habitat Context": "Funerary context—placed within nested coffins inside the burial chamber.",
        "Symbolism": "Gold symbolized divine flesh; blue represented rebirth and cosmic order; the nemes headdress marked royal sovereignty.",
        "Comparison": "Comparable to the mask of Tutankhamun; stylistically related to masks from the tombs of Yuya and Thuya.",
      }
    },
  ],
  anthropology: [
    {
      img: 'images/collections/artefact antr 1.jpeg',
      alt: 'Fang Ritual Mask',
      data: {
        "Name": "Fang Ritual Mask",
        "Material": "Carved wood coated with white kaolin, natural pigments (red ochre, charcoal), raffia attachments.",
        "Size/Weight/Shape": "Approx. 45 cm high, oval face, elongated nose, narrow eyes; lightweight (under 1 kg).",
        "Estimated Age": "19th century CE, Fang people, northern Gabon and southern Cameroon.",
        "Condition": "Good; surface erosion from ritual handling; original pigment layers partially preserved.",
        "Find Location": "Collected near Oyem region, Gabon, from a Ngil initiation society house.",
        "Use and Function": "Used during initiation and purification rituals (Ngil society) to maintain social harmony and justice.",
        "Probable Purpose": "Spiritual; represented ancestor spirits who watched over the living and punished wrongdoing.",
        "Evidence of Use": "Kaolin and soot residues; abrasion from repeated ceremonial handling and exposure to firelight.",
        "Manufacturing Clues": "Carved with iron adzes; coated with white clay (kaolin) symbolizing purity and connection to the ancestral world.",
        "Cultural Context": "Part of Fang ancestor cult emphasizing moral order and the transmission of spiritual authority through lineage.",
        "Found With": "Wooden reliquary boxes (byeri), ritual weapons, and musical instruments (drums, rattles).",
        "Burial or Habitat Context": "Stored in village sanctuaries or initiation lodges; not buried with individuals.",
        "Symbolism": "White kaolin = purity and spirit world; elongated face symbolizes the wisdom of ancestors.",
        "Comparison": "Comparable to Punu masks but more stylized and abstract; influenced European modernist art (Picasso, Modigliani).",
      }
    },
    {
      img: 'images/collections/artefact antr 2.jpeg',
      alt: 'Tlingit Ceremonial Staff',
      data: {
        "Name": "Tlingit Ceremonial Staff",
        "Material": "Carved red cedar wood with abalone shell, copper, and pigment inlays.",
        "Size/Weight/Shape": "Approx. 1.2 m tall; cylindrical shaft topped with carved zoomorphic figure (raven or bear); weight around 2–3 kg.",
        "Estimated Age": "Late 18th–early 19th century CE, Tlingit culture, Pacific Northwest Coast (Alaska and British Columbia).",
        "Condition": "Very good; minor pigment fading, some loss of shell inlay, but carvings remain clear.",
        "Find Location": "Collected from a Tlingit clan house near Sitka, Alaska.",
        "Use and Function": "Held by chiefs or shamans during potlatch ceremonies to assert status and spiritual authority.",
        "Probable Purpose": "Political and ceremonial symbol of lineage power and ancestral heritage.",
        "Evidence of Use": "Polished grip from repeated handling; residue of ceremonial oils; traces of pigment on the carved surface.",
        "Manufacturing Clues": "Carved from single cedar piece using stone and metal tools; designs painted with natural pigments and shell inlays fixed with resin.",
        "Cultural Context": "Tlingit society placed high importance on clan lineage; ceremonial staffs represented the voice of the ancestors during rituals.",
        "Found With": "Clan regalia such as masks, woven blankets, and copper shields.",
        "Burial or Habitat Context": "Kept in clan houses; sometimes buried with high-ranking individuals.",
        "Symbolism": "Animal motifs (raven, bear, eagle) signify clan identity and the link between human and spirit worlds.",
        "Comparison": "Comparable to Haida and Kwakwaka’wakw ceremonial staffs with similar totemic symbolism and craftsmanship.",
      }
    },
    {
      img: 'images/collections/artefact antr 3.jpeg',
      alt: 'Paracas Funerary Tapestry',
      data: {
        "Name": "Paracas Funerary Tapestry",
        "Material": "Cotton warp and camelid wool weft, dyed with cochineal red, indigo, and plant-based yellow pigments.",
        "Size/Weight/Shape": "Approx. 1.5 m x 1 m; rectangular textile; light and flexible, estimated weight under 1 kg.",
        "Estimated Age": "Late Paracas Necropolis phase, around 300–100 BCE.",
        "Condition": "Fragile; some areas faded or frayed; pigment retention high due to dry coastal climate.",
        "Find Location": "Excavated from Wari Kayan necropolis, Paracas Peninsula, Peru.",
        "Use and Function": "Used as funerary wrapping for elite mummies, layered with multiple textiles and ritual items.",
        "Probable Purpose": "Funerary and symbolic—ensuring protection and transformation of the deceased into a divine ancestor.",
        "Evidence of Use": "Fiber deformation and organic staining from mummified remains; folded edges consistent with wrapping use.",
        "Manufacturing Clues": "Woven on backstrap loom; embroidered with supernatural figures using double-cloth technique and dyed camelid fibers.",
        "Cultural Context": "Represents one of the earliest examples of complex textile iconography in the Andes; precursor to Nazca artistic traditions.",
        "Found With": "Ceramic vessels, feather ornaments, and gold adornments.",
        "Burial or Habitat Context": "Funerary context—placed in mummy bundles of high-ranking individuals.",
        "Symbolism": "Depicts supernatural beings in flight, symbolizing the journey of the soul to the afterlife and cosmic regeneration.",
        "Comparison": "Comparable to later Nazca textiles; shares similar themes of transformation, fertility, and sacred duality.",
      }
    },
  ],
  assemblages: [
    {
      img: 'images/collections/assemblages.jpeg',
      alt: 'Mjölnir And Bronze Age Burial',
      data: {
        "Name": "Mjölnir And Bronze Age Burial",
        "Material": "Medium-sized tool/weapon, probably between 30 and 50 cm long (including handle). A cubic and massive hammer head (Mjölnir type), with a traditional hammer/mace head, mounted on a cylindrical handle covered in leather. Head in blackened metal/wrought iron or dark stone with bronze inlays (runes) and a central light blue jewel (crystal/glass). Handle covered in brown leather and adorned with silver/pewter metal (wolf/dragon head at the base). Bronze, Clay, Textile",
        "Size/Weight/Shape": "Clay pot: About 30 cm high, 40 cm in diameter, globular shape with a flat base and wide opening. Estimated weight: 3–5 kg. / Bronze figurine: About 20 cm high, 15 cm long, shaped like a stylized animal (goat or ram). Estimated weight: 1–2 kg. / Textile: Fragment about 20x30 cm, irregular rectangular shape. Lightweight.",
        "Estimated Age": "Legendary artifact; its style suggests a hypothetical dating to the Viking Age (c. 800 - 1050 AD), with a modern/fantasy interpretation. Clay pot and bronze figurine: Probably from the Middle to Late Bronze Age, around 2000–1200 BCE (for example, Aegean or Near Eastern culture)./ Textile: Harder to date precisely without analysis, but possibly from the same time period if found in the same context, or slightly later (Iron Age or Classical period).",
        "Condition": "Excellent / Mythical. The edges are crisp, the leather is intact (but patinated), and the luminous inlays are perfect (which is purely fantastic for an archaeological artifact). Excellent;minor restoration on pottery",
        "Find Location": "Found in the right hand of the deceased, in a ship gravetard, coastal Norway Hypothetically from an archaeological site in Anatolia, Mesopotamia, or the Aegean region (Greece, Crete). For example, from a burial mound or the ruins of an ancient city.",
        "Use and Function": "Clay pot: Storage container for food or liquids, or a funerary urn./ Bronze figurine: Votive offering in a sanctuary, decorative object, or possibly a game piece or prestige toy. / Textile: Piece of clothing, blanket, carpet, or funerary shroud.",
        "Probable Purpose": "Clay pot: Domestic, ritual, or funerary use./ Bronze figurine: Religious/spiritual (representation of an animal deity, symbol of fertility or protection), or social (marker of status)./ Textile: Domestic use, clothing, or funerary ritual.",
        "Evidence of Use": "Weak/None. There are no chips, battle marks or real wear, which reinforces its status as a mythical or ceremonial object.Clay pot: Signs of wear inside (if used for liquids or food), organic residues, or handling marks if it was a funerary urn. Minor restoration suggests it was broken and repaired. / Bronze figurine: Uniform patina indicating long exposure, possibly with polished areas from human contact. / Textile: Worn fibers, stains, or permanent folds from use or storage.",
        "Manufacturing Clues": "Clay pot: Made on a potter’s wheel (visible concentric grooves), painted decoration (slip) before firing. / Bronze figurine: Cast using the lost-wax technique (a sophisticated method), with traces of post-casting engraving or finishing./ Textile: Hand-woven (visible irregularities), with embroidered or woven-in patterns.",
        "Cultural Context": "A central object in Norse mythology. If real, it could be a votive hammer, a symbol of faith worn as a pendant (miniature Mjölnir were common) or a clan chief's weapon. Depends on the hypothetical location and dating. Could belong to a palace culture of the Bronze Age (Minoan, Mycenaean), or to Mesopotamian or Hittite civilizations. These objects reveal aspects of craftsmanship, religious beliefs, and social organization.",
        "Found With": "Clay pot, bronze figurine, textile: May have been found together in a tomb (with human remains, jewelry, other ceramics), a votive deposit, or a treasure cache.",
        "Burial or Habitat Context": "Funerary context: Buried in a sarcophagus or pit, often with personal objects of the deceased for the afterlife./ Habitat context: Found in the ruins of a house, workshop, or temple, indicating domestic or ritual use.",
        "Symbolism": "Represents Strength, Protection, and Divine Authority (Thor, the god of thunder and protector of Asgard and Midgard). Illuminated runes refer to Magic or cosmic Power. Symbol of life (food), death (urn), or prosperity. / Bronze figurine (animal): May represent strength, fertility, a protective spirit, or a chthonic/celestial deity, or serve as a totemic symbol./ Textile: Symbol of social status (through quality of weaving), cultural identity (through patterns), or transition (as a burial shroud).",
        "Comparison": "Similar to the Mjölnir pendants found, but on a much larger scale. Echoes medieval warhammers, but with a purely Nordic aesthetic and symbolism. Comparable to Minoan Kamares-style pottery or ancient Near Eastern ceramics with geometric decoration. / Bronze figurine: Similar to Anatolian or Cretan votive figurines from the Bronze Age. / Textile: Comparable to textile fragments found in Egyptian tombs or Scandinavian Bronze Age sites, based on weaving techniques and dyes.",
      }
    },
  ],
  historie: [], // Ajouté pour gérer les cas sans données
};

// Fonction pour charger le contenu des sections externes (Staff, Collections, Shop)
async function loadSectionContent(sectionId, path) {
  const el = document.getElementById(sectionId);
  // load content
  if (el && el.innerHTML.trim() === "") {
    try {
      const response = await fetch(path);
      if (!response.ok) {
        throw new Error(`${response.statusText}`);
      }
      const htmlContent = await response.text();
      el.innerHTML = htmlContent;
    } catch (error) {
      console.error(`Error loading ${path}:`, error);
      el.innerHTML = `<p>Error loading ${sectionId}. Please check the file path: ${path}</p>`;
    }
  }
}

/* Fonction pour basculer l'affichage des sections principales */
async function showSection(section) {
  const sections = ['home', 'staff', 'collections', 'shop'];
  const subNav = document.getElementById('sub-nav');

  // hide all sections
  sections.forEach(id => {
    const el = document.getElementById(id + '-section');
    if (el) {
      el.classList.remove('visible');
      el.classList.add('hidden');
    }
  });

  // hide sub-navigation
  subNav.classList.add('hidden');

  // get active section
  const active = document.getElementById(section + '-section');

  if (active) {
    // load content if necessary
    if (section === 'staff') {
      await loadSectionContent('staff-section', 'html/staff.html');
    }

    if (section === 'collections') {
      // load collections wrapper
      await loadSectionContent('collections-section', 'html/collections.html');

      // display sub-nav
      subNav.classList.remove('hidden');

      // load 'archaeology' by default
      showCollectionInfo('archaeology');
    }

    if (section === 'shop') {
      await loadSectionContent('shop-section', 'html/shop.html');
    }

    // show active section
    active.classList.remove('hidden');
    active.classList.add('visible');
  }
}


/* Génère le HTML pour un artefact */
function artifactHTML(imgSrc, imgAlt, data) {
  // data 
  // Utilisation de <article class="staff-card"> pour réutiliser le style de base
  return `
  <article class="staff-card artifact">
    <div class="portrait">
      <img src="${imgSrc}" alt="${imgAlt}">
    </div>
    <div class="staff-meta">
      <h3>${data.Name}</h3>
      
      <div class="artifact-details">
        <p><strong>Name:</strong> ${data.Name}</p>
        <p><strong>Material:</strong> ${data.Material}</p>
        <p><strong>Size/Weight/Shape:</strong> ${data['Size/Weight/Shape']}</p>
        <p><strong>Estimated Age:</strong> ${data['Estimated Age']}</p>
        <p><strong>Condition:</strong> ${data['Condition']}</p>
        <p><strong>Find Location:</strong> ${data['Find Location']}</p>
        <p><strong>Use and Function:</strong> ${data['Use and Function']}</p>
        <p><strong>Probable Purpose:</strong> ${data['Probable Purpose']}</p>
        <p><strong>Evidence of Use:</strong> ${data['Evidence of Use']}</p>
        <p><strong>Manufacturing Clues:</strong> ${data['Manufacturing Clues']}</p>
        <p><strong>Cultural Context:</strong> ${data['Cultural Context']}</p>
        <p><strong>Found With:</strong> ${data['Found With']}</p>
        <p><strong>Burial or Habitat Context:</strong> ${data['Burial or Habitat Context']}</p>
        <p><strong>Symbolism:</strong> ${data['Symbolism']}</p>
        <p><strong>Comparison:</strong> ${data['Comparison']}</p>
      </div>
    </div>
  </article>
  `;
}

/* Fonction pour afficher les informations d'une collection spécifique */
function showCollectionInfo(category) {
  const container = document.getElementById('collection-info');

  if (!container) {
    console.warn("showCollectionInfo(category) a été appelé avant que #collection-info ne soit chargé.");
    return;
  }
  
  // Affiche le titre de la catégorie
  container.innerHTML = `<h2 class="collection-title">${category.charAt(0).toUpperCase() + category.slice(1)} Collection</h2>`;

  const dataArray = artifactsData[category] || [];

  if (dataArray.length === 0) {
    container.innerHTML += `<p>Content for the <strong>${category}</strong> section is currently unavailable.</p>`;
    return;
  }

  // Génère le HTML des artefacts à partir des données
  dataArray.forEach(item => {
    container.innerHTML += artifactHTML(item.img, item.alt, item.data);
  });
}

// === MODAL LOGIC ===
// Ajout du titre et de la description de l'article de la boutique dans la modale
function openModal(imgSrc, itemName) {
    const modal = document.getElementById('item-modal');
    const modalImg = document.getElementById('modal-img');
    const modalTitle = document.getElementById('modal-title');
    const modalDesc = document.getElementById('modal-desc');

    // Trouver l'élément dans le DOM du magasin pour récupérer la description
    const itemElement = document.querySelector(`.souvenir-item[title="${itemName}"]`);
    let desc = "No description available.";
    
    if(itemElement) {
        // La description est dans la première balise <p> après <h3>
        const pElement = itemElement.querySelector('p:not(.price)');
        if(pElement) {
            desc = pElement.innerText;
        }
    }

    modalImg.src = imgSrc;
    modalImg.alt = itemName; 
    modalTitle.innerText = itemName;
    modalDesc.innerText = desc;
    
    modal.classList.remove('hidden');
}


function closeModal() {
  const modal = document.getElementById('item-modal');
  modal.classList.add('hidden');
}

// optional: close modal when clicking outside content
window.onclick = function(e) {
  const modal = document.getElementById('item-modal');
  if (e.target === modal) {
    closeModal();
  }
};

/* CORRECTION IMPORTANTE : Afficher la section 'home' au chargement */
document.addEventListener('DOMContentLoaded', () => {
    // S'assurer que la section 'home' est visible par défaut au chargement
    showSection('home');
});

// Fonction factice pour le bouton "Add to Cart"
function addToCart(itemId, name, price) {
    console.log(`Item added to cart: ${name} (${price})`);
    alert(`Added ${name} to your virtual cart!`);
}